(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function R(t=16,n="display-p3"){if(t<2)throw Error("Quantity per channel cannot be lower than 2.");const e=Array.from({length:t},(r,a)=>a/(t-1)),o=[];for(let r of e)for(let a of e)for(let i of e)o.push(m(r,a,i,n));return o}function k(t=3,n="display-p3"){const e=[];for(let o=0;o<t;o++)e.push(m(1,1,1,n)),e.push(m(0,0,0,n));return e.push(m(1,1,1,n)),e}function m(t,n,e,o){return`color(${o} ${t.toFixed(6)} ${n.toFixed(6)} ${e.toFixed(6)})`}const B=t=>(n,e)=>(t.set(n,e),e),v=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,P=536870912,T=P*2,A=(t,n)=>e=>{const o=n.get(e);let r=o===void 0?e.size:o<T?o+1:0;if(!e.has(r))return t(e,r);if(e.size<P){for(;e.has(r);)r=Math.floor(Math.random()*T);return t(e,r)}if(e.size>v)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;e.has(r);)r=Math.floor(Math.random()*v);return t(e,r)},x=new WeakMap,W=B(x),E=A(W,x),Q=t=>typeof t.start=="function",b=new WeakMap,U=t=>({...t,connect:({call:n})=>async()=>{const{port1:e,port2:o}=new MessageChannel,r=await n("connect",{port:e},[e]);return b.set(o,r),o},disconnect:({call:n})=>async e=>{const o=b.get(e);if(o===void 0)throw new Error("The given port is not connected.");await n("disconnect",{portId:o})},isSupported:({call:n})=>()=>n("isSupported")}),h=new WeakMap,$=t=>{if(h.has(t))return h.get(t);const n=new Map;return h.set(t,n),n},G=t=>{const n=U(t);return e=>{const o=$(e);e.addEventListener("message",(({data:c})=>{const{id:u}=c;if(u!==null&&o.has(u)){const{reject:l,resolve:p}=o.get(u);o.delete(u),c.error===void 0?p(c.result):l(new Error(c.error.message))}})),Q(e)&&e.start();const r=(c,u=null,l=[])=>new Promise((p,L)=>{const g=E(o);o.set(g,{reject:L,resolve:p}),u===null?e.postMessage({id:g,method:c},l):e.postMessage({id:g,method:c,params:u},l)}),a=(c,u,l=[])=>{e.postMessage({id:null,method:c,params:u},l)};let i={};for(const[c,u]of Object.entries(n))i={...i,[c]:u({call:r,notify:a})};return{...i}}},D=t=>n=>e=>{typeof t.get(e)=="symbol"&&(t.set(e,null),n(e).then(()=>{t.delete(e)}))},j=t=>n=>e=>{typeof t.get(e)=="symbol"&&(t.set(e,null),n(e).then(()=>{t.delete(e)}))},z=(t,n)=>e=>(o,r=0,...a)=>{const i=Symbol(),c=t(n);n.set(c,i);const u=()=>e(r,c).then(()=>{const l=n.get(c);if(l===void 0)throw new Error("The timer is in an undefined state.");l===i&&(o(...a),n.get(c)===i&&u())});return u(),c},X=(t,n)=>e=>(o,r=0,...a)=>{const i=Symbol(),c=t(n);return n.set(c,i),e(r,c).then(()=>{const u=n.get(c);if(u===void 0)throw new Error("The timer is in an undefined state.");u===i&&(n.delete(c),o(...a))}),c},C=new Map([[0,null]]),S=new Map([[0,null]]),H=D(C),K=j(S),Y=z(E,C),J=X(E,S),V=G({clearInterval:({call:t})=>H(n=>t("clear",{timerId:n,timerType:"interval"})),clearTimeout:({call:t})=>K(n=>t("clear",{timerId:n,timerType:"timeout"})),setInterval:({call:t})=>Y((n,e)=>t("set",{delay:n,now:performance.timeOrigin+performance.now(),timerId:e,timerType:"interval"})),setTimeout:({call:t})=>J((n,e)=>t("set",{delay:n,now:performance.timeOrigin+performance.now(),timerId:e,timerType:"timeout"}))}),Z=t=>{const n=new Worker(t);return V(n)},ee=(t,n)=>{let e=null;return()=>{if(e!==null)return e;const o=new Blob([n],{type:"application/javascript; charset=utf-8"}),r=URL.createObjectURL(o);return e=t(r),setTimeout(()=>URL.revokeObjectURL(r)),e}},te=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,u=r(i),c=a(u,i),l=t(c);e.addUniqueNumber=l,e.generateUniqueNumber=c}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:u}})=>{const c=r[i];try{if(void 0===c)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===u?c():c(u);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const u=new Map,c=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(u);return u.set(o,()=>{n(),t.close(),u.delete(o)}),{result:o}},disconnect:({portId:e})=>{const r=u.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise(e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])})){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=c(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},d=(e,t)=>r=>{const n=t.get(r);if(void 0===n)return Promise.resolve(!1);const[o,s]=n;return e(o),t.delete(r),s(!1),Promise.resolve(!0)},f=(e,t,r,n)=>(o,s,a)=>{const i=o+s-t.timeOrigin,u=i-t.now();return new Promise(t=>{e.set(a,[r(n,u,i,e,t,a),t])})},m=new Map,h=d(globalThis.clearTimeout,m),p=new Map,v=d(globalThis.clearTimeout,p),w=((e,t)=>{const r=(n,o,s,a)=>{const i=n-e.now();i>0?o.set(a,[t(r,i,n,o,s,a),s]):(o.delete(a),s(!0))};return r})(performance,globalThis.setTimeout),g=f(m,performance,globalThis.setTimeout,w),T=f(p,performance,globalThis.setTimeout,w);l(self,{clear:async({timerId:e,timerType:t})=>({result:await("interval"===t?h(e):v(e))}),set:async({delay:e,now:t,timerId:r,timerType:n})=>({result:await("interval"===n?g:T)(e,t,r)})})})()})();`,O=ee(Z,te),ne=t=>O().clearTimeout(t),M=(...t)=>O().setTimeout(...t);function I(t,n){let e=new Date().getTime()+n,o=null;const r=function(){return e+=n,o=M(r,e-new Date().getTime()),t()},a=function(){if(o!==null)return ne(o)};return o=M(r,e-new Date().getTime()),{cancel:a}}const w=document.getElementById("background"),re=document.getElementById("status"),d=document.getElementById("colorSpace"),_=document.getElementById("colourPatchesPerChannel"),oe=document.getElementById("colourPatchesInfo"),f=document.getElementById("fullscreenButton"),se=document.getElementById("settingsButton"),q=document.getElementById("settingsDialog"),ae=document.getElementById("closeDialog"),y=document.querySelector('[data-mode="patchesRemaining"]'),s={colorSpace:ce(),colourPatchesPerChannel:20,interval:200,running:!1,preQueueIdx:0,queueIdx:0,preQueue:[],queue:[]};re.addEventListener("click",t=>{const n=t.target,{mode:e}=n.dataset;switch(e){case"start":ue();break;case"stop":N();break}});f.addEventListener("click",()=>{ie()});se.addEventListener("click",()=>{q.showModal()});ae.addEventListener("click",()=>{q.close()});d.addEventListener("change",t=>{const n=t.target;le(n.value)});_.addEventListener("change",t=>{const n=t.target;de(parseInt(n.value))});function ce(){return window.matchMedia("(color-gamut: rec2020)").matches?"rec2020":window.matchMedia("(color-gamut: p3)").matches?"display-p3":"srgb"}function ue(){if(s.running===!0)return;const t=()=>new Promise(e=>{s.preQueue=k(3,s.colorSpace);const o=I(()=>{s.running===!1||s.preQueueIdx===s.preQueue.length?(o.cancel(),e()):(w.style.backgroundColor=s.preQueue[s.preQueueIdx],s.preQueueIdx++,y.textContent="Pre-Start")},1e3)}),n=()=>new Promise(e=>{s.queue=R(s.colourPatchesPerChannel,s.colorSpace);const o=I(()=>{s.running===!1||s.queueIdx===s.queue.length?(o.cancel(),N(),e()):(w.style.backgroundColor=s.queue[s.queueIdx],s.queueIdx++,y.textContent=`${s.queue.length-s.queueIdx}`)},s.interval)});s.running=!0,t().then(()=>n())}function N(){s.running=!1,s.preQueueIdx=0,s.queueIdx=0,w.style.backgroundColor="",y.textContent="Finished"}function ie(){document.fullscreenElement?(document.exitFullscreen(),f.textContent="Fullscreen"):(document.documentElement.requestFullscreen().catch(t=>{console.error(`Error attempting to enable fullscreen: ${t.message}`)}),f.textContent="Exit Fullscreen")}document.addEventListener("fullscreenchange",()=>{document.fullscreenElement?f.textContent="Exit Fullscreen":f.textContent="Fullscreen"});function le(t){s.running===!1&&(s.colorSpace=t)}function de(t){s.running===!1&&(s.colourPatchesPerChannel=t,F())}function F(){const t=Math.pow(s.colourPatchesPerChannel,3),n=t*s.interval/1e3+7,e=Math.floor(n/60),o=Math.round(n%60);oe.textContent=`${t.toLocaleString()} total patches (~${e}m ${o}s)`}function fe(){const t=d.querySelectorAll("option"),n=window.matchMedia("(color-gamut: p3)").matches,e=window.matchMedia("(color-gamut: rec2020)").matches;t.forEach(r=>{const a=r.getAttribute("data-gamut");(a==="p3"&&!n||a==="rec2020"&&!e)&&(r.disabled=!0,r.textContent+=" (Not Supported)")});const o=d.querySelector(`option[value="${s.colorSpace}"]`);o&&o.disabled&&(s.colorSpace="srgb",d.value="srgb")}function me(){fe(),d.value=s.colorSpace,_.value=s.colourPatchesPerChannel.toString(),F()}me();
