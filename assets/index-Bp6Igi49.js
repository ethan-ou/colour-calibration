(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function F(e=16,r="srgb"){if(e<2)throw Error("Quantity per channel cannot be lower than 2.");const t=S(e),n=[];for(let o=0;o<t.length;o++)for(let a=0;a<t.length;a++)for(let u=0;u<t.length;u++)n.push(f(t[o],t[a],t[u],r));return n}function $(e=33,r="srgb"){if(e<2)throw Error("Quantity cannot be lower than 2.");return S(e).map(n=>f(n,n,n,r))}function Q(e=3,r="srgb"){const t=[];for(let n=0;n<e;n++)t.push(f(1,1,1,r)),t.push(f(0,0,0,r));return t.push(f(1,1,1,r)),t}function f(e,r,t,n){return`color(${n} ${e.toFixed(6)} ${r.toFixed(6)} ${t.toFixed(6)})`}function S(e){const r=[];for(let t=0;t<e;t++){const n=t/(e-1);r.push(n)}return r}const G=e=>(r,t)=>(e.set(r,t),t),b=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,C=536870912,E=C*2,U=(e,r)=>t=>{const n=r.get(t);let o=n===void 0?t.size:n<E?n+1:0;if(!t.has(o))return e(t,o);if(t.size<C){for(;t.has(o);)o=Math.floor(Math.random()*E);return e(t,o)}if(t.size>b)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;t.has(o);)o=Math.floor(Math.random()*b);return e(t,o)},O=new WeakMap,W=G(O),v=U(W,O),D=e=>typeof e.start=="function",P=new WeakMap,j=e=>({...e,connect:({call:r})=>async()=>{const{port1:t,port2:n}=new MessageChannel,o=await r("connect",{port:t},[t]);return P.set(n,o),n},disconnect:({call:r})=>async t=>{const n=P.get(t);if(n===void 0)throw new Error("The given port is not connected.");await r("disconnect",{portId:n})},isSupported:({call:r})=>()=>r("isSupported")}),p=new WeakMap,z=e=>{if(p.has(e))return p.get(e);const r=new Map;return p.set(e,r),r},X=e=>{const r=j(e);return t=>{const n=z(t);t.addEventListener("message",(({data:c})=>{const{id:i}=c;if(i!==null&&n.has(i)){const{reject:l,resolve:h}=n.get(i);n.delete(i),c.error===void 0?h(c.result):l(new Error(c.error.message))}})),D(t)&&t.start();const o=(c,i=null,l=[])=>new Promise((h,B)=>{const m=v(n);n.set(m,{reject:B,resolve:h}),i===null?t.postMessage({id:m,method:c},l):t.postMessage({id:m,method:c,params:i},l)}),a=(c,i,l=[])=>{t.postMessage({id:null,method:c,params:i},l)};let u={};for(const[c,i]of Object.entries(r))u={...u,[c]:i({call:o,notify:a})};return{...u}}},H=e=>r=>t=>{typeof e.get(t)=="symbol"&&(e.set(t,null),r(t).then(()=>{e.delete(t)}))},K=e=>r=>t=>{typeof e.get(t)=="symbol"&&(e.set(t,null),r(t).then(()=>{e.delete(t)}))},Y=(e,r)=>t=>(n,o=0,...a)=>{const u=Symbol(),c=e(r);r.set(c,u);const i=()=>t(o,c).then(()=>{const l=r.get(c);if(l===void 0)throw new Error("The timer is in an undefined state.");l===u&&(n(...a),r.get(c)===u&&i())});return i(),c},V=(e,r)=>t=>(n,o=0,...a)=>{const u=Symbol(),c=e(r);return r.set(c,u),t(o,c).then(()=>{const i=r.get(c);if(i===void 0)throw new Error("The timer is in an undefined state.");i===u&&(r.delete(c),n(...a))}),c},q=new Map([[0,null]]),x=new Map([[0,null]]),J=H(q),Z=K(x),ee=Y(v,q),te=V(v,x),re=X({clearInterval:({call:e})=>J(r=>e("clear",{timerId:r,timerType:"interval"})),clearTimeout:({call:e})=>Z(r=>e("clear",{timerId:r,timerType:"timeout"})),setInterval:({call:e})=>ee((r,t)=>e("set",{delay:r,now:performance.timeOrigin+performance.now(),timerId:t,timerType:"interval"})),setTimeout:({call:e})=>te((r,t)=>e("set",{delay:r,now:performance.timeOrigin+performance.now(),timerId:t,timerType:"timeout"}))}),ne=e=>{const r=new Worker(e);return re(r)},oe=(e,r)=>{let t=null;return()=>{if(t!==null)return t;const n=new Blob([r],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(n);return t=e(o),setTimeout(()=>URL.revokeObjectURL(o)),t}},se=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,u=r(i),c=a(u,i),l=t(c);e.addUniqueNumber=l,e.generateUniqueNumber=c}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:u}})=>{const c=r[i];try{if(void 0===c)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===u?c():c(u);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const u=new Map,c=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(u);return u.set(o,()=>{n(),t.close(),u.delete(o)}),{result:o}},disconnect:({portId:e})=>{const r=u.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise(e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])})){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=c(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},d=(e,t)=>r=>{const n=t.get(r);if(void 0===n)return Promise.resolve(!1);const[o,s]=n;return e(o),t.delete(r),s(!1),Promise.resolve(!0)},f=(e,t,r,n)=>(o,s,a)=>{const i=o+s-t.timeOrigin,u=i-t.now();return new Promise(t=>{e.set(a,[r(n,u,i,e,t,a),t])})},m=new Map,h=d(globalThis.clearTimeout,m),p=new Map,v=d(globalThis.clearTimeout,p),w=((e,t)=>{const r=(n,o,s,a)=>{const i=n-e.now();i>0?o.set(a,[t(r,i,n,o,s,a),s]):(o.delete(a),s(!0))};return r})(performance,globalThis.setTimeout),g=f(m,performance,globalThis.setTimeout,w),T=f(p,performance,globalThis.setTimeout,w);l(self,{clear:async({timerId:e,timerType:t})=>({result:await("interval"===t?h(e):v(e))}),set:async({delay:e,now:t,timerId:r,timerType:n})=>({result:await("interval"===n?g:T)(e,t,r)})})})()})();`,L=oe(ne,se),ae=e=>L().clearTimeout(e),T=(...e)=>L().setTimeout(...e);function I(e,r){let t=new Date().getTime()+r,n=null;const o=function(){return t+=r,n=T(o,t-new Date().getTime()),e()},a=function(){if(n!==null)return ae(n)};return n=T(o,t-new Date().getTime()),{cancel:a}}const w=document.getElementById("background"),ce=document.getElementById("status"),g=document.getElementById("colorSpace"),k=document.getElementById("colourPatchesPerChannel"),N=document.getElementById("grayscalePatches"),ue=document.getElementById("colourPatchesInfo"),ie=document.getElementById("grayscalePatchesInfo"),le=document.getElementById("settingsButton"),d=document.getElementById("settingsDialog"),de=document.getElementById("closeDialog"),y=document.querySelector('[data-mode="patchesRemaining"]'),s={mode:"colour",colorSpace:"srgb",colourPatchesPerChannel:16,grayscalePatches:32,interval:500,running:!1,preQueueIdx:0,queueIdx:0,preQueue:[],queue:[]};ce.addEventListener("click",e=>{const r=e.target,{mode:t}=r.dataset;switch(t){case"start":fe();break;case"stop":_();break}});d.addEventListener("click",e=>{const r=e.target,{mode:t}=r.dataset;switch(t){case"colour":M(t);break;case"grayscale":M(t);break}});le.addEventListener("click",()=>{d.showModal()});de.addEventListener("click",()=>{d.close()});g.addEventListener("change",e=>{const r=e.target;ge(r.value)});k.addEventListener("change",e=>{const r=e.target;he(parseInt(r.value))});N.addEventListener("change",e=>{const r=e.target;me(parseInt(r.value))});function fe(){if(s.running===!0)return;const e=()=>new Promise(t=>{s.preQueue=Q(3,s.colorSpace);const n=I(()=>{s.running===!1||s.preQueueIdx===s.preQueue.length?(n.cancel(),t()):(w.style.backgroundColor=s.preQueue[s.preQueueIdx],s.preQueueIdx++,y.textContent="Pre-Start")},1e3)}),r=()=>new Promise(t=>{switch(s.mode){case"colour":s.queue=F(s.colourPatchesPerChannel,s.colorSpace);break;case"grayscale":s.queue=$(s.grayscalePatches,s.colorSpace);break}const n=I(()=>{s.running===!1||s.queueIdx===s.queue.length?(n.cancel(),_(),t()):(w.style.backgroundColor=s.queue[s.queueIdx],s.queueIdx++,y.textContent=`${s.queue.length-s.queueIdx}`)},s.interval)});s.running=!0,e().then(()=>r())}function _(){s.running=!1,s.preQueueIdx=0,s.queueIdx=0,w.style.backgroundColor="",y.textContent="Finished"}function M(e){s.running===!1&&(s.mode=e,d.querySelectorAll("button[data-mode]").forEach(r=>r.classList.remove("active")),d.querySelector(`[data-mode="${e}"]`)?.classList.add("active"))}function ge(e){s.running===!1&&(s.colorSpace=e)}function he(e){s.running===!1&&(s.colourPatchesPerChannel=e,R())}function me(e){s.running===!1&&(s.grayscalePatches=e,A())}function R(){const e=Math.pow(s.colourPatchesPerChannel,3),r=e*s.interval/1e3,t=Math.floor(r/60),n=Math.round(r%60);ue.textContent=`${e.toLocaleString()} total patches (~${t}m ${n}s)`}function A(){const e=s.grayscalePatches,r=e*s.interval/1e3,t=Math.floor(r/60),n=Math.round(r%60);ie.textContent=`${e.toLocaleString()} total patches (~${t}m ${n}s)`}function pe(){const e=g.querySelectorAll("option"),r=window.matchMedia("(color-gamut: p3)").matches,t=window.matchMedia("(color-gamut: rec2020)").matches;e.forEach(o=>{const a=o.getAttribute("data-gamut");(a==="p3"&&!r||a==="rec2020"&&!t)&&(o.disabled=!0,o.textContent+=" (Not Supported)")});const n=g.querySelector(`option[value="${s.colorSpace}"]`);n&&n.disabled&&(s.colorSpace="srgb",g.value="srgb")}function we(){pe(),d.querySelectorAll("button[data-mode]").forEach(e=>e.classList.remove("active")),d.querySelector(`[data-mode="${s.mode}"]`)?.classList.add("active"),g.value=s.colorSpace,k.value=s.colourPatchesPerChannel.toString(),N.value=s.grayscalePatches.toString(),R(),A()}we();
