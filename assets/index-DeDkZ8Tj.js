(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function $(e=16,n="srgb"){if(e<2)throw Error("Quantity per channel cannot be lower than 2.");const t=x(e),r=[];for(let o=0;o<t.length;o++)for(let a=0;a<t.length;a++)for(let u=0;u<t.length;u++)r.push(f(t[o],t[a],t[u],n));return r}function Q(e=33,n="srgb"){if(e<2)throw Error("Quantity cannot be lower than 2.");return x(e).map(r=>f(r,r,r,n))}function G(e=3,n="srgb"){const t=[];for(let r=0;r<e;r++)t.push(f(1,1,1,n)),t.push(f(0,0,0,n));return t.push(f(1,1,1,n)),t}function f(e,n,t,r){return`color(${r} ${e.toFixed(6)} ${n.toFixed(6)} ${t.toFixed(6)})`}function x(e){const n=[];for(let t=0;t<e;t++){const r=t/(e-1);n.push(r)}return n}const U=e=>(n,t)=>(e.set(n,t),t),b=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,C=536870912,P=C*2,W=(e,n)=>t=>{const r=n.get(t);let o=r===void 0?t.size:r<P?r+1:0;if(!t.has(o))return e(t,o);if(t.size<C){for(;t.has(o);)o=Math.floor(Math.random()*P);return e(t,o)}if(t.size>b)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;t.has(o);)o=Math.floor(Math.random()*b);return e(t,o)},q=new WeakMap,D=U(q),E=W(D,q),j=e=>typeof e.start=="function",T=new WeakMap,z=e=>({...e,connect:({call:n})=>async()=>{const{port1:t,port2:r}=new MessageChannel,o=await n("connect",{port:t},[t]);return T.set(r,o),r},disconnect:({call:n})=>async t=>{const r=T.get(t);if(r===void 0)throw new Error("The given port is not connected.");await n("disconnect",{portId:r})},isSupported:({call:n})=>()=>n("isSupported")}),w=new WeakMap,X=e=>{if(w.has(e))return w.get(e);const n=new Map;return w.set(e,n),n},H=e=>{const n=z(e);return t=>{const r=X(t);t.addEventListener("message",(({data:c})=>{const{id:i}=c;if(i!==null&&r.has(i)){const{reject:l,resolve:h}=r.get(i);r.delete(i),c.error===void 0?h(c.result):l(new Error(c.error.message))}})),j(t)&&t.start();const o=(c,i=null,l=[])=>new Promise((h,A)=>{const p=E(r);r.set(p,{reject:A,resolve:h}),i===null?t.postMessage({id:p,method:c},l):t.postMessage({id:p,method:c,params:i},l)}),a=(c,i,l=[])=>{t.postMessage({id:null,method:c,params:i},l)};let u={};for(const[c,i]of Object.entries(n))u={...u,[c]:i({call:o,notify:a})};return{...u}}},K=e=>n=>t=>{typeof e.get(t)=="symbol"&&(e.set(t,null),n(t).then(()=>{e.delete(t)}))},Y=e=>n=>t=>{typeof e.get(t)=="symbol"&&(e.set(t,null),n(t).then(()=>{e.delete(t)}))},V=(e,n)=>t=>(r,o=0,...a)=>{const u=Symbol(),c=e(n);n.set(c,u);const i=()=>t(o,c).then(()=>{const l=n.get(c);if(l===void 0)throw new Error("The timer is in an undefined state.");l===u&&(r(...a),n.get(c)===u&&i())});return i(),c},J=(e,n)=>t=>(r,o=0,...a)=>{const u=Symbol(),c=e(n);return n.set(c,u),t(o,c).then(()=>{const i=n.get(c);if(i===void 0)throw new Error("The timer is in an undefined state.");i===u&&(n.delete(c),r(...a))}),c},L=new Map([[0,null]]),O=new Map([[0,null]]),Z=K(L),ee=Y(O),te=V(E,L),ne=J(E,O),re=H({clearInterval:({call:e})=>Z(n=>e("clear",{timerId:n,timerType:"interval"})),clearTimeout:({call:e})=>ee(n=>e("clear",{timerId:n,timerType:"timeout"})),setInterval:({call:e})=>te((n,t)=>e("set",{delay:n,now:performance.timeOrigin+performance.now(),timerId:t,timerType:"interval"})),setTimeout:({call:e})=>ne((n,t)=>e("set",{delay:n,now:performance.timeOrigin+performance.now(),timerId:t,timerType:"timeout"}))}),oe=e=>{const n=new Worker(e);return re(n)},se=(e,n)=>{let t=null;return()=>{if(t!==null)return t;const r=new Blob([n],{type:"application/javascript; charset=utf-8"}),o=URL.createObjectURL(r);return t=e(o),setTimeout(()=>URL.revokeObjectURL(o)),t}},ae=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,u=r(i),c=a(u,i),l=t(c);e.addUniqueNumber=l,e.generateUniqueNumber=c}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:u}})=>{const c=r[i];try{if(void 0===c)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===u?c():c(u);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const u=new Map,c=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(u);return u.set(o,()=>{n(),t.close(),u.delete(o)}),{result:o}},disconnect:({portId:e})=>{const r=u.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise(e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])})){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=c(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},d=(e,t)=>r=>{const n=t.get(r);if(void 0===n)return Promise.resolve(!1);const[o,s]=n;return e(o),t.delete(r),s(!1),Promise.resolve(!0)},f=(e,t,r,n)=>(o,s,a)=>{const i=o+s-t.timeOrigin,u=i-t.now();return new Promise(t=>{e.set(a,[r(n,u,i,e,t,a),t])})},m=new Map,h=d(globalThis.clearTimeout,m),p=new Map,v=d(globalThis.clearTimeout,p),w=((e,t)=>{const r=(n,o,s,a)=>{const i=n-e.now();i>0?o.set(a,[t(r,i,n,o,s,a),s]):(o.delete(a),s(!0))};return r})(performance,globalThis.setTimeout),g=f(m,performance,globalThis.setTimeout,w),T=f(p,performance,globalThis.setTimeout,w);l(self,{clear:async({timerId:e,timerType:t})=>({result:await("interval"===t?h(e):v(e))}),set:async({delay:e,now:t,timerId:r,timerType:n})=>({result:await("interval"===n?g:T)(e,t,r)})})})()})();`,k=se(oe,ae),ce=e=>k().clearTimeout(e),I=(...e)=>k().setTimeout(...e);function M(e,n){let t=new Date().getTime()+n,r=null;const o=function(){return t+=n,r=I(o,t-new Date().getTime()),e()},a=function(){if(r!==null)return ce(r)};return r=I(o,t-new Date().getTime()),{cancel:a}}const y=document.getElementById("background"),ue=document.getElementById("status"),m=document.getElementById("colorSpace"),N=document.getElementById("colourPatchesPerChannel"),_=document.getElementById("grayscalePatches"),ie=document.getElementById("colourPatchesInfo"),le=document.getElementById("grayscalePatchesInfo"),g=document.getElementById("fullscreenButton"),de=document.getElementById("settingsButton"),d=document.getElementById("settingsDialog"),fe=document.getElementById("closeDialog"),v=document.querySelector('[data-mode="patchesRemaining"]'),s={mode:"colour",colorSpace:"srgb",colourPatchesPerChannel:16,grayscalePatches:32,interval:500,running:!1,preQueueIdx:0,queueIdx:0,preQueue:[],queue:[]};ue.addEventListener("click",e=>{const n=e.target,{mode:t}=n.dataset;switch(t){case"start":me();break;case"stop":B();break}});d.addEventListener("click",e=>{const n=e.target,{mode:t}=n.dataset;switch(t){case"colour":S(t);break;case"grayscale":S(t);break}});g.addEventListener("click",()=>{ge()});de.addEventListener("click",()=>{d.showModal()});fe.addEventListener("click",()=>{d.close()});m.addEventListener("change",e=>{const n=e.target;he(n.value)});N.addEventListener("change",e=>{const n=e.target;pe(parseInt(n.value))});_.addEventListener("change",e=>{const n=e.target;we(parseInt(n.value))});function me(){if(s.running===!0)return;const e=()=>new Promise(t=>{s.preQueue=G(3,s.colorSpace);const r=M(()=>{s.running===!1||s.preQueueIdx===s.preQueue.length?(r.cancel(),t()):(y.style.backgroundColor=s.preQueue[s.preQueueIdx],s.preQueueIdx++,v.textContent="Pre-Start")},1e3)}),n=()=>new Promise(t=>{switch(s.mode){case"colour":s.queue=$(s.colourPatchesPerChannel,s.colorSpace);break;case"grayscale":s.queue=Q(s.grayscalePatches,s.colorSpace);break}const r=M(()=>{s.running===!1||s.queueIdx===s.queue.length?(r.cancel(),B(),t()):(y.style.backgroundColor=s.queue[s.queueIdx],s.queueIdx++,v.textContent=`${s.queue.length-s.queueIdx}`)},s.interval)});s.running=!0,e().then(()=>n())}function B(){s.running=!1,s.preQueueIdx=0,s.queueIdx=0,y.style.backgroundColor="",v.textContent="Finished"}function S(e){s.running===!1&&(s.mode=e,d.querySelectorAll("button[data-mode]").forEach(n=>n.classList.remove("active")),d.querySelector(`[data-mode="${e}"]`)?.classList.add("active"))}function ge(){document.fullscreenElement?(document.exitFullscreen(),g.textContent="Fullscreen"):(document.documentElement.requestFullscreen().catch(e=>{console.error(`Error attempting to enable fullscreen: ${e.message}`)}),g.textContent="Exit Fullscreen")}document.addEventListener("fullscreenchange",()=>{document.fullscreenElement?g.textContent="Exit Fullscreen":g.textContent="Fullscreen"});function he(e){s.running===!1&&(s.colorSpace=e)}function pe(e){s.running===!1&&(s.colourPatchesPerChannel=e,F())}function we(e){s.running===!1&&(s.grayscalePatches=e,R())}function F(){const e=Math.pow(s.colourPatchesPerChannel,3),n=e*s.interval/1e3,t=Math.floor(n/60),r=Math.round(n%60);ie.textContent=`${e.toLocaleString()} total patches (~${t}m ${r}s)`}function R(){const e=s.grayscalePatches,n=e*s.interval/1e3,t=Math.floor(n/60),r=Math.round(n%60);le.textContent=`${e.toLocaleString()} total patches (~${t}m ${r}s)`}function ye(){const e=m.querySelectorAll("option"),n=window.matchMedia("(color-gamut: p3)").matches,t=window.matchMedia("(color-gamut: rec2020)").matches;e.forEach(o=>{const a=o.getAttribute("data-gamut");(a==="p3"&&!n||a==="rec2020"&&!t)&&(o.disabled=!0,o.textContent+=" (Not Supported)")});const r=m.querySelector(`option[value="${s.colorSpace}"]`);r&&r.disabled&&(s.colorSpace="srgb",m.value="srgb")}function ve(){ye(),d.querySelectorAll("button[data-mode]").forEach(e=>e.classList.remove("active")),d.querySelector(`[data-mode="${s.mode}"]`)?.classList.add("active"),m.value=s.colorSpace,N.value=s.colourPatchesPerChannel.toString(),_.value=s.grayscalePatches.toString(),F(),R()}ve();
